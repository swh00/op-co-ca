# Cost-Benefit Blueprint (기회비용 계산기)

Cost-Benefit Blueprint는 사용자가 자신만의 의사결정 템플릿을 생성하고, 정량적인 점수를 통해 최적의 선택을 할 수 있도록 돕는 웹 애플리케이션입니다.  

Next.js 14와 Supabase를 기반으로 구축되었으며, 네트워크 연결이 없는 환경에서도 사용할 수 있도록 **오프라인 우선(Offline-First) 아키텍처**가 적용되었습니다.

---

## 🚀 주요 기능

### 1️⃣ 템플릿 빌더
- 가중치(Weight)와 유형(Benefit/Cost)을 설정
- 나만의 계산 템플릿 생성

### 2️⃣ 하이브리드 저장소
- 🔒 **로컬 저장**
  - 로그인 없이 브라우저에 즉시 저장
  - 오프라인 지원
- ☁️ **서버 공유**
  - Supabase DB에 저장
  - 링크로 다른 사람과 공유 가능

### 3️⃣ 실시간 계산
- 입력값에 따라 즉시 점수 및 순위 산출

### 4️⃣ PWA 지원
- 데스크톱 및 모바일에서 네이티브 앱처럼 설치 및 사용 가능

---

## 🛠 기술 스택 (Tech Stack)

| 영역 | 기술 |
|------|------|
| Framework | Next.js 14 (App Router) |
| Language | TypeScript |
| Styling | Tailwind CSS, Shadcn UI |
| Icons | Lucide React |
| State Management | Zustand |
| Database | Supabase (PostgreSQL) |
| Testing | Playwright |

---

## 🏗 아키텍처: 오프라인 우선 하이브리드 로직

이 프로젝트는 네트워크 상태에 구애받지 않는 사용자 경험을 제공하기 위해  
**Server DB + LocalStorage 하이브리드 패턴**을 구현했습니다.

---

### 1️⃣ 데이터 저장 전략 (Dual Write Strategy)

`SaveButton.tsx` 컴포넌트에서 네트워크 상태(`useOnlineStatus`)와 사용자 의도에 따라 저장 경로를 분기합니다.

#### 🔒 내 장치에 저장 (Local)

- 인터넷 연결 여부와 관계없이 `localStorage`의 `recent_templates` 키에 JSON 형태로 저장
- ID는 충돌 방지를 위해 `local_` 접두사 + UUID 조합으로 생성  
  - 예: `local_1234...`
- 데이터는 사용자의 브라우저에만 존재
- 서버로 전송되지 않음 (**Privacy First**)

#### ☁️ 서버에 공유 (Public)

- 네트워크 연결 상태에서만 활성화
- Supabase의 `templates` 테이블에 저장
- 생성된 UUID를 통해 고유 URL(`/calc/[id]`) 생성

---

### 2️⃣ 데이터 조회 및 렌더링 (Hybrid Read)

#### 📂 메인 화면 (MyLibrary)

- `localStorage` 데이터와 서버 데이터를 병합하지 않음
- 로컬 데이터를 우선적으로 표시하여 빠른 로딩 속도 보장

#### 🧮 계산기 페이지 (`/calc/[id]`)

- URL 파라미터 `id`가 `local_`로 시작하면:
  - 서버 요청 없이 `LocalCalculatorLoader` 컴포넌트가 작동
  - 로컬 스토리지에서 데이터 로드
- 일반 UUID인 경우:
  - `TemplateService`를 통해 Supabase에서 실시간 Fetch

---

## 📦 설치 및 실행 방법

### 1️⃣ 레포지토리 클론

~~~bash
git clone https://github.com/your-username/cost-benefit-blueprint.git
cd cost-benefit-blueprint
~~~

---

### 2️⃣ 패키지 설치

~~~bash
npm install
~~~

---

### 3️⃣ 환경 변수 설정

최상위 경로에 `.env.local` 파일을 생성하고 Supabase 키를 입력하세요.

~~~env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
~~~

---

### 4️⃣ 개발 서버 실행

~~~bash
npm run dev
~~~

브라우저에서 아래 주소로 접속합니다:

```
http://localhost:3000
```

---

# 📘 기회비용 계산기 사용자 가이드

환영합니다!  

기회비용 계산기는 복잡한 고민들을 숫자로 명확하게 비교하여, 후회 없는 선택을 하도록 도와주는 도구입니다.  

이 가이드는 앱을 설치하고, 인터넷 없이도 템플릿을 관리하는 방법을 안내합니다.

---

## 📲 1. 앱 설치하기 (PWA)

이 웹사이트는 앱 스토어 없이도 스마트폰이나 PC에 설치하여 앱처럼 사용할 수 있습니다.

---

### 📱 아이폰 (iOS / Safari)

1. Safari 브라우저 하단의 **공유 버튼** 클릭  
2. 메뉴를 아래로 내려 **'홈 화면에 추가'** 선택  
3. 우측 상단의 **'추가'** 버튼 클릭  

홈 화면에 아이콘이 생성됩니다.

---

### 🤖 안드로이드 (Android / Chrome)

1. Chrome 브라우저 우측 상단 **점 3개 메뉴** 클릭  
2. **'앱 설치'** 또는 **'홈 화면에 추가'** 선택  

설치 후 앱 서랍이나 홈 화면에서 실행 가능합니다.

---

### 💻 PC (Chrome / Edge)

1. 주소창 우측의 **설치 아이콘** 클릭  
2. **'설치'** 버튼 클릭  

바탕화면에 아이콘이 생성됩니다.

---

## 💾 2. 템플릿 만들고 저장하기

### 🛠 나만의 계산기 만들기

1. 홈 화면에서 **'새 템플릿 만들기'** 클릭  
2. 제목 입력 (예: 이직 결정, 새 차 구매 비교)  
3. 평가 기준 추가  

- **이득 (Benefit)**: 높을수록 좋은 항목  
  - 예: 연봉, 디자인 점수  
- **비용 (Cost)**: 낮을수록 좋은 항목  
  - 예: 야근 빈도, 가격  

4. 각 기준의 **중요도(가중치)** 설정  

---

### 💾 저장 방식 선택 (중요!)

| 기능 | 내 장치에 저장 🔒 | 서버에 공유 ☁️ |
|------|-------------------|----------------|
| 인터넷 필요 | ❌ 필요 없음 | ✅ 필요 |
| 보안 | 내 브라우저에만 저장 | 링크 공유 가능 |
| 접근성 | 저장한 기기에서만 열람 | 어디서든 접근 가능 |
| 추천 상황 | 개인 고민, 오프라인 | 공유 목적 |

💡 **팁:**  
비행기 안이나 인터넷이 없는 곳에서는 **'내 장치에 저장'**을 사용하세요.  
인터넷이 연결되어도 데이터는 안전하게 유지됩니다.

---

## 📂 3. 저장된 템플릿 관리하기

### 📚 내 보관함 (My Library)

홈 화면의 **'최근 열어본 템플릿'** 또는 **'내 보관함'** 섹션에서 확인할 수 있습니다.

- **Local 태그**
  - 기기에만 저장된 템플릿
  - 브라우저 쿠키/캐시 삭제 시 함께 삭제될 수 있음
- **JSON 내보내기**
  - 계산기 화면 상단의 **'JSON 내보내기'** 버튼 클릭
  - 파일로 백업 가능

---

## 🌐 오프라인 상태일 때

인터넷 연결이 끊겨도 걱정하지 마세요.

- 상단에 **"오프라인 상태입니다"** 알림 표시
- 로컬 템플릿 수정 및 계산 가능
- 새로운 템플릿 생성 및 로컬 저장 가능

---
